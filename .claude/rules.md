# nowtask 開発ルール

## プロジェクト概要
nowtaskは、vanilla JavaScript/HTML/CSSで構築されたタスク管理アプリケーションです。
フレームワークやライブラリを使用せず、localStorageでデータを永続化します。

## 技術スタック
- **JavaScript**: Vanilla JS (ES6+)
- **CSS**: Pure CSS (フレームワーク不使用)
- **HTML**: セマンティックHTML5
- **ストレージ**: localStorage
- **依存関係**: なし（完全にスタンドアロン）

## コーディング規約

### JavaScript
- グローバル変数は最小限に抑える
- 関数は単一責任の原則に従う
- コメントは日本語で記述
- 定数は`UPPER_SNAKE_CASE`で命名
- 関数名は`camelCase`で命名
- ファイルは機能ごとに分割（各ファイル300-400行を目安）

### CSS
- クラス名は`kebab-case`で命名
- BEM命名規則を推奨
- メディアクエリは各セクションの最後にまとめる
- **カラーは白と黒のみ使用（グレースケールのみ）**
- カラーコード: `#000000` (黒), `#FFFFFF` (白), `#F5F5F5` (背景グレー), `#E0E0E0` (ボーダーグレー), `#9E9E9E` (テキストグレー), `#757575` (セカンダリテキスト), `#333333` (ダークグレー)
- コメントで明確にセクション分け

### HTML
- セマンティックタグを使用
- アクセシビリティ属性を適切に設定（aria-label, titleなど）
- idは必要最小限に使用
- classは再利用可能に設計

## ファイル構成

```
nowtask5/
├── index.html              # メインHTML
├── style.css               # タスク、モーダル、フォームスタイル
├── css/
│   ├── style-base.css      # 基本スタイル、ヘッダー、タブ
│   └── style-components.css # ゲージ、FAB、完了済みセクション
└── js/
    ├── core.js             # 定数、ユーティリティ関数
    ├── tasks.js            # タスクCRUD、ルーティン機能
    ├── render.js           # レンダリング、DOM操作
    ├── modals.js           # モーダル管理、設定
    ├── gauge.js            # 24時間ゲージ機能
    ├── events.js           # イベントリスナー設定
    └── ui-main.js          # 初期化、メイン処理
```

## 機能実装ルール

### データ構造
- タスクオブジェクトは必須プロパティを常に含める
- ISO 8601形式で日時を保存
- UUID v4形式でIDを生成
- 削除時はゴミ箱に30日間保持

### UI/UX
- **Material Designの原則に従う**
- **色は白と黒のみ使用（カラフルな色は禁止）**
- レスポンシブデザインを維持
- トランジションは0.2-0.3秒
- ホバー効果は控えめに
- タッチデバイスでも使いやすいサイズ（最小44x44px）

### パフォーマンス
- DOM操作は最小限に
- イベントデリゲーションを活用
- 大量データ表示時は仮想化を検討
- localStorageの容量制限に注意

## 禁止事項

### ❌ ダークモードは追加しない
このアプリケーションにダークモードは実装しません。
ライトモードのみで統一されたUIを維持します。

### ❌ カラフルな色の使用禁止
- 青、赤、緑、オレンジなどのカラフルな色は使用しない
- 使用可能な色は白、黒、グレーのみ
- グラデーションも白黒グレーのみ

### ❌ 外部ライブラリの使用禁止
- jQuery、React、Vue.jsなどのフレームワーク
- Bootstrap、Tailwind CSSなどのCSSフレームワーク
- momentjs、lodashなどのユーティリティライブラリ

### ❌ サーバーサイド処理の禁止
- すべてクライアントサイドで完結
- API呼び出しは行わない
- バックエンドは不要

## 新機能追加時の確認事項

1. **既存機能への影響確認**
   - 既存のタスクデータとの互換性
   - 既存のUI/UXとの整合性
   - パフォーマンスへの影響

2. **データ移行**
   - 新しいプロパティ追加時は既存データとの互換性を確保
   - デフォルト値を適切に設定

3. **テスト項目**
   - 新規タスク作成
   - タスク編集・削除
   - サブタスク機能
   - ルーティン機能
   - ゴミ箱機能
   - 24時間ゲージ表示

4. **ブラウザ互換性**
   - Chrome、Firefox、Safari、Edgeで動作確認
   - モバイルブラウザでの動作確認

## コミットメッセージ規約

```
<type>: <subject>

<body>
```

### Type
- `feat`: 新機能
- `fix`: バグ修正
- `refactor`: リファクタリング
- `style`: スタイル変更（コードの動作に影響なし）
- `docs`: ドキュメント変更
- `perf`: パフォーマンス改善

### 例
```
feat: デイリールーティン機能を追加

朝食、昼食、夕食、歯磨き、睡眠の5つのルーティンを
毎日自動的にタスクとして作成できる機能を実装
```

## デバッグ方法

1. **Console.log は本番前に削除**
2. **localStorage のデータ確認**
   ```javascript
   // Chromeコンソールで実行
   JSON.parse(localStorage.getItem('nowtask_tasks'))
   ```
3. **エラーハンドリング**
   - try-catchで適切にエラーを処理
   - ユーザーに分かりやすいエラーメッセージを表示

## パフォーマンス目標

- 初回ロード: 1秒以内
- タスク作成・更新: 100ms以内
- レンダリング: 60fps維持
- localStorage容量: 5MB以下

## アクセシビリティ

- キーボード操作のみで全機能を使用可能
- スクリーンリーダー対応
- 十分なコントラスト比を確保（WCAG AA準拠）
- フォーカス状態を明確に表示

## 今後の開発方針

### 許可される機能追加
- タスクのカテゴリ分け
- タスクの検索・フィルタリング
- データのエクスポート/インポート
- タスクの並び替え（ドラッグ&ドロップ）
- ショートカットキー

### 禁止される機能追加
- **ダークモード** （明示的に禁止）
- 同期機能（クラウド連携）
- ユーザー認証
- 複数ユーザー対応
- リアルタイム通知

## 質問・相談

コードに関する質問や新機能の提案は、このルールに従っているか確認してから実施してください。
特にダークモードに関する提案は受け付けません。
